# :salt: Salt-projektidokumentaatio

## :open_book: Projektin yleiskatsaus

T√§ss√§ dokumentissa k√§sitell√§√§n SaltStack-konfiguraation k√§ytt√∂√§ Vagrantin hallinnoimissa virtuaalikoneissa Windows-koneen PowerShelliss√§. Kohdeymp√§rist√∂n√§ ovat VirtualBoxin virtuaalikoneet, master ja minion.

### :computer: Ymp√§rist√∂

- :window: 	K√§ytt√∂j√§rjestelm√§ on Windows
- :package: 	Projektin hallinta Vagrantilla
- :scroll: 	Lisenssi: GNU General Public License v3
- :cd: 		Virtuaalikoneiden k√§ytt√∂j√§rjestelm√§: "debian/bullseye64"
- üñ•Ô∏è   	Virtual box virtuaalikoneiden ajamiseen

### :clock3: Projektin aikataulu
- Ty√∂ on alkanut klo 10:00 üìÜ5/9/2024
- Esivalmistelut on dokumentoitu Githubiin klo 13:25 üìÜ5/9/2024 

### :memo: Lis√§tietoja
T√§ss√§ osiossa voidaan k√§sitell√§ projektin muita yksityiskohtia, kuten asennusohjeita, konfiguraatioesimerkkej√§ ja yll√§pitotietoja.

1Ô∏è‚É£ 	Tarvitset vagrantin koneelle. Asenna t√§m√§ omalle k√§ytt√∂j√§rjestelm√§llesi. (https://developer.hashicorp.com/vagrant/install)

2Ô∏è‚É£ 	Tarvitset Virtual boxin mill√§ suoritat n√§it√§ virtuaalikoneita. Asenna t√§m√§ omalle k√§ytt√∂j√§rjestelm√§llesi. (https://www.virtualbox.org/wiki/Downloads)

3Ô∏è‚É£	Tallenna vagrant tiedosto vagrant kansioon seuraten ohjeita vaikka teron sivulta: https://terokarvinen.com/2021/two-machine-virtual-network-with-debian-11-bullseye-and-vagrant/

- # Vagrant Configuration (karvinen2017)

T√§ss√§ konfiguroidaan kaksi Debian Bullseye 64 -virtuaalikonetta Vagrantin avulla. 

## Vagrantfile

```ruby
# -*- mode: ruby -*-
# vi: set ft=ruby :
# Copyright 2019-2021 Tero Karvinen http://TeroKarvinen.com

$tscript = <<TSCRIPT
set -o verbose
apt-get update
apt-get -y install tree
echo "Done - set up test environment - https://terokarvinen.com/search/?q=vagrant"
TSCRIPT

Vagrant.configure("2") do |config|
	config.vm.synced_folder ".", "/vagrant", disabled: true
	config.vm.synced_folder "shared/", "/home/vagrant/shared", create: true
	config.vm.provision "shell", inline: $tscript
	config.vm.box = "debian/bullseye64"

	config.vm.define "t001" do |t001|
		t001.vm.hostname = "t001"
		t001.vm.network "private_network", ip: "192.168.88.101"
	end

	config.vm.define "t002", primary: true do |t002|
		t002.vm.hostname = "t002"
		t002.vm.network "private_network", ip: "192.168.88.102"
	end
	
end
```

4Ô∏è‚É£ # SaltStackin Asennus ja Konfiguraatio Windows Powershelliss√§

T√§ss√§ dokumentissa k√§yd√§√§n l√§pi, miten SaltStackin master ja minion -instanssit asennetaan ja konfiguroidaan k√§ytt√§en kahta erillist√§ Windows Powershelli√§, joissa on j√§rjestelm√§nvalvojan oikeudet.

## Ymp√§rist√∂n Pystytys

1. **Avaa kaksi Powershell-ikkunaa** Windowsissa j√§rjestelm√§nvalvojan oikeuksilla.
2. **K√§ynnist√§ virtuaalikoneet** Yhdess√§ Powershell-ikkunassa k√§ytt√§en komentoa:
   ```bash
   vagrant up
**Yhdist√§ t001-koneeseen ensimm√§isest√§ Powershell-ikkunasta:**
```bash
vagrant ssh t001
```
**Yhdist√§ t002-koneeseen toisesta Powershell-ikkunasta:**
```bash
vagrant ssh t002
```
**Suorita kummallakin virtuaalikoneella seuraava komento p√§ivitt√§√§ksesi pakettilistat:**
```sudo apt-get update```

**Asenna Salt Master t001-koneelle k√§ytt√§en komentoa:**
```sudo apt-get -y install salt-master```

**Asenna Salt Minion t002-koneelle k√§ytt√§en komentoa:**
```sudo apt-get -y install salt-minion```

**Muokkaa salt-minion konfiguraatiotiedostoa t002-koneella k√§ytt√§en komentoa:**
```sudo nano /etc/salt/minion```

**Lis√§√§ tiedostoon masterin IP-osoite: master: 192.168.88.101**
**Tallenna tiedosto ja poistu nano-editorista painamalla Ctrl+X, vahvista tallennus Y-n√§pp√§imell√§ ja poistu Enter-n√§pp√§imell√§.
K√§ynnist√§ Salt Minion uudelleen k√§ytt√§en komentoa: sudo systemctl restart salt-minion**

![Nanolla lis√§t√§√§n Masterin osoite minionille](https://github.com/Linux88888/Palvelintenhallinta/assets/143414956/62e76075-0e2a-47ad-86a2-3d6887ca04b5)

(Nanolla lis√§t√§√§n Masterin osoite minionille yll√§ olevassa kuvassa.)

**Tarkista odottavat avaimet t001-koneella k√§ytt√§en komentoa:**
```sudo salt-key -L```

**Hyv√§ksy odottavat avaimet k√§ytt√§en komentoa:**
```sudo salt-key -A```

![Odottava avain hyv√§ksytty](https://github.com/Linux88888/Palvelintenhallinta/assets/143414956/785ef675-09ba-4eb2-8101-10b440a1bb4d)

(Odottava avain hyv√§ksytty yll√§ olevassa kuvassa.)

### :bulb: Sivun ulkoasu
Projektidokumentaation sivu on suunniteltu tummalla teemalla. Jos haluat muuttaa t√§m√§n valkoiseksi, voit lis√§t√§ Markdown-tiedostoon CSS-s√§√§nt√∂j√§, jos alusta tukee t√§t√§. Esimerkiksi GitHubin tai muiden alustojen yhteydess√§ sinun tulee mukauttaa teemaa muilla ty√∂kaluilla tai asetuksilla.


L√§hteet:
- [https://terokarvinen.com/2017/provision-multiple-virtual-puppet-slaves-with-vagrant/](https://terokarvinen.com/2021/two-machine-virtual-network-with-debian-11-bullseye-and-vagrant/)
- https://developer.hashicorp.com/vagrant/install
- https://www.virtualbox.org/wiki/Downloads
- 
